<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VFind - Profil</title>
  <link rel="stylesheet" href="style/main.css"/>
</head>
<body class="vfind-bg">
  <header>
    <h1>👤 Mon Profil</h1>
    <nav>
      <a href="index.html">🏠 Accueil</a>
      <a href="historique.html">📜 Historique</a>
    </nav>
  </header>

  <main>
    <section class="profil-info">
      <p><strong>Pseudo :</strong> <span id="pseudo">Invité</span></p>
      <p><strong>Points :</strong> <span id="points">0</span></p>
      <p><strong>Cadre sélectionné :</strong> <span id="cadre-actuel">Aucun</span></p>
      <p><strong>Statut :</strong> <span id="premium-status">Chargement...</span></p>
    </section>

    <section class="cadres-possedes">
      <h2>🎨 Mes cadres</h2>
      <div id="profil-cadres-container" class="grid-cadres"></div>
    </section>

    <div id="user-nickname">Chargement du pseudo...</div>

    <section class="likes-section">
      <h2>❤️ Photos aimées</h2>
      <div class="photo-gallery" id="liked-photos-gallery"></div>
    </section>

    <section class="signaled-section">
      <h2>🚩 Photos signalées</h2>
      <div class="photo-gallery" id="signaled-photos-gallery"></div>
    </section>
  </main>

  <footer>
    <p>© 2025 VFind</p>
  </footer>

  <script src="js/userData.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const container = document.getElementById("profil-cadres-container");
      const pseudoSpan = document.getElementById("pseudo");
      const pointsSpan = document.getElementById("points");
      const cadreActuelSpan = document.getElementById("cadre-actuel");
      const premiumSpan = document.getElementById("premium-status");

      const userData = JSON.parse(localStorage.getItem("vfindUserData")) || {};
      const ownedFrames = userData.cadres || [];
      const cadreActif = userData.cadreActif || "polaroid_01";

      pseudoSpan.textContent = userData.pseudo || "Invité";
      pointsSpan.textContent = userData.coins || 0;
      cadreActuelSpan.textContent = cadreActif;
      premiumSpan.textContent = userData.premium ? "🌟 Premium actif" : "🆓 Compte gratuit";

      fetch("data/cadres.json")
        .then(res => res.json())
        .then(data => {
          data.forEach(cadre => {
            if (!ownedFrames.includes(cadre.id)) return;

            const item = document.createElement("div");
            item.classList.add("cadre-item");

            const preview = document.createElement("div");
            preview.className = "cadre-preview";

            const photo = document.createElement("img");
            photo.src = "assets/img/exemple.jpg";
            photo.className = "photo-user profil";

            const cadreImg = document.createElement("img");
            cadreImg.src = `assets/cadres/${cadre.id}.webp`;
            cadreImg.className = "photo-cadre";

            preview.appendChild(photo);
            preview.appendChild(cadreImg);

            const title = document.createElement("h3");
            title.textContent = cadre.nom;

            const button = document.createElement("button");
            button.textContent = cadre.id === cadreActif ? "✅ Utilisé" : "Utiliser";
            if (cadre.id === cadreActif) button.disabled = true;

            button.addEventListener("click", () => {
              userData.cadreActif = cadre.id;
              localStorage.setItem("vfindUserData", JSON.stringify(userData));
              location.reload();
            });

            item.appendChild(preview);
            item.appendChild(title);
            item.appendChild(button);
            container.appendChild(item);
          });
        });
    });
  </script>
</body>
</html>
