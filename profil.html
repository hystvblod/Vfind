<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VFind - Profil</title>
  <link rel="stylesheet" href="style/main.css"/>
</head>
<body class="vfind-bg">
  <header>
    <h1>ğŸ‘¤ Mon Profil</h1>
    <nav>
      <a href="index.html">ğŸ  Accueil</a>
      <a href="historique.html">ğŸ“œ Historique</a>
    </nav>
  </header>

  <main>
    <section class="profil-info">
      <p><strong>Pseudo :</strong> <span id="pseudo">InvitÃ©</span></p>
      <p><strong>Points :</strong> <span id="points">0</span></p>
      <p><strong>Cadre sÃ©lectionnÃ© :</strong> <span id="cadre-actuel">Aucun</span></p>
      <p><strong>Statut :</strong> <span id="premium-status">Chargement...</span></p>
    </section>

    <!-- âœ… Section affichant les cadres possÃ©dÃ©s -->
    <section class="cadres-possedes">
      <h2>ğŸ¨ Mes cadres</h2>
      <div class="grid-cadres" id="cadres-list"></div>
    </section>

    <!-- âœ… AperÃ§u du cadre sÃ©lectionnÃ© -->
    <div class="cadre-preview">
      <img class="photo-cadre" id="cadre-preview-img" src="./assets/cadres/polaroid_01.webp" />
      <img class="photo-user" src="./assets/img/exemple.jpg" alt="AperÃ§u">
    </div>

    <div id="user-nickname">Chargement du pseudo...</div>

    <section class="likes-section">
      <h2>â¤ï¸ Photos aimÃ©es</h2>
      <div class="photo-gallery" id="liked-photos-gallery"></div>
    </section>

    <section class="signaled-section">
      <h2>ğŸš© Photos signalÃ©es</h2>
      <div class="photo-gallery" id="signaled-photos-gallery"></div>
    </section>
  </main>

  <footer>
    <p>Â© 2025 VFind</p>
  </footer>

  <!-- âœ… Script propre et unique -->
  <script src="js/userData.js"></script>
  <script>
    // Chargement des donnÃ©es du profil
    const data = getUserData();
    document.getElementById("pseudo").textContent = data.pseudo;
    document.getElementById("points").textContent = data.coins;
    document.getElementById("premium-status").textContent = data.premium ? "ğŸŒŸ Premium actif" : "ğŸ†“ Compte gratuit";

    // Chargement du cadre actif
    const cadreActuel = localStorage.getItem("cadre_selectionne") || "Aucun";

    // PrÃ©affichage de l'image sÃ©lectionnÃ©e
    const previewImage = document.getElementById("cadre-preview-img");
    if (cadreActuel !== "Aucun") {
      previewImage.src = `./assets/cadres/${cadreActuel}.webp`;
    }

    const cadresPossedes = getCadresPossedes();

    // Chargement du JSON de cadres
    fetch('./data/cadres.json')
      .then(response => response.json())
      .then(cadresData => {
        // Nom lisible du cadre sÃ©lectionnÃ©
        const cadreInfo = cadresData.find(c => c.id === cadreActuel);
        document.getElementById("cadre-actuel").textContent = cadreInfo ? cadreInfo.nom : cadreActuel;

        // Affichage des cadres possÃ©dÃ©s
        const cadresContainer = document.getElementById("cadres-list");
        cadresPossedes.forEach(cadre => {
          const cadreData = cadresData.find(c => c.id === cadre);
          const nomLisible = cadreData ? cadreData.nom : cadre;

          const div = document.createElement("div");
          div.className = "cadre-item";
          div.innerHTML = `
            <img src="./assets/cadres/${cadre}.webp" alt="${nomLisible}" />
            <p style="margin: 10px 0 6px; font-weight: bold;">${nomLisible}</p>
            <button onclick="selectionnerCadre('${cadre}')" ${cadre === cadreActuel ? "disabled" : ""}>
              ${cadre === cadreActuel ? "âœ… UtilisÃ©" : "Utiliser"}
            </button>
          `;
          cadresContainer.appendChild(div);
        });
      })
      .catch(error => {
        console.error("Erreur lors du chargement des noms de cadres :", error);
        document.getElementById("cadre-actuel").textContent = cadreActuel;
      });

    // SÃ©lection dâ€™un cadre
    function selectionnerCadre(nomCadre) {
      localStorage.setItem("cadre_selectionne", nomCadre);
      alert("âœ… Cadre sÃ©lectionnÃ© !");
      location.reload();
    }
  </script>
</body>
</html>
