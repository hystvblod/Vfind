<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VFind - Mes cadres</title>
  <link rel="stylesheet" href="style/main.css"/>
</head>
<body class="cadres-container">
  <header class="profil-header">
    <a href="profil.html" class="back-btn" title="Retour">&#8592;</a>
    <h1>Mes cadres</h1>
  </header>

  <main>
    <section class="cadres-possedes">
      <div class="grid-cadres" id="cadres-list">
        <!-- Les cadres possédés seront injectés ici -->
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 VFind</p>
  </footer>

  <script src="js/userData.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const data = getUserData();
      data.cadres = data.cadres.map(id => {
        const num = id.replace(/[^\d]/g, "");
        const padded = num.padStart(2, "0");
        return "polaroid_" + padded;
      });
      saveUserData(data);

      const cadresPossedes = getCadresPossedes();
      const cadreActif = getCadreSelectionne();
      const container = document.getElementById("cadres-list");

      cadresPossedes.forEach(cadre => {
        const div = document.createElement("div");
        div.className = "cadre-item";
        div.innerHTML = `
          <div class="cadre-preview" onclick="zoomCadre('${cadre}')">
            <img class="photo-cadre" src="./assets/cadres/${cadre}.webp" />
            <img class="photo-user" src="./assets/img/exemple.jpg" />
          </div>
          <button onclick="selectionnerCadre('${cadre}')" ${cadre === cadreActif ? "disabled" : ""}>
            ${cadre === cadreActif ? "Utilisé" : "Utiliser"}
          </button>
        `;
        container.appendChild(div);
      });
    });

    function selectionnerCadre(id) {
      setCadreSelectionne(id);
      alert("✅ Cadre sélectionné !");
      location.reload();
    }

    function zoomCadre(id) {
      const popup = document.createElement("div");
      popup.className = "popup show";
      popup.innerHTML = `
        <div class="popup-inner">
          <button id="close-popup" onclick="document.body.removeChild(this.parentNode.parentNode)">✖</button>
          <div class="cadre-preview cadre-popup">
            <img class="photo-cadre" src="./assets/cadres/${id}.webp" />
            <img class="photo-user" src="./assets/img/exemple.jpg" />
          </div>
        </div>
      `;
      document.body.appendChild(popup);
    }
  </script>
</body>
</html>
