<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VFind - Mes cadres</title>
  <link rel="stylesheet" href="style/main.css"/>
</head>

<body class="vfind-bg">

  <header class="profil-header">
    <a href="profil.html" class="back-btn">🔙</a>
    <h1>🎨 Mes cadres</h1>
  </header>

  <main>
    <section class="cadres-possedes">
      <div class="grid-cadres" id="cadres-list">
        <!-- Les cadres possédés seront injectés ici -->
      </div>
    </section>
  </main>

  <!-- ✅ POPUP PLATO STYLE -->
  <div id="popup-cadre" class="popup hidden">
    <div class="popup-inner">
      <button id="close-popup" class="close-btn">❌</button>
      <div class="cadre-preview cadre-popup">
        <img id="popup-cadre-img" class="photo-cadre" src="" />
        <img id="popup-photo-user" class="photo-user" src="./assets/img/exemple.jpg" />
      </div>
      <button class="main-button" id="confirmer-cadre">✅ Utiliser ce cadre</button>
    </div>
  </div>

  <footer>
    <p>© 2025 VFind</p>
  </footer>

  <script>
    const cadreActuel = localStorage.getItem("cadre_selectionne") || "polaroid_01";
    const tousLesCadres = ["polaroid_01", "polaroid_02", "polaroid_03", "polaroid_04"];
    const cadresPossedes = (JSON.parse(localStorage.getItem("vfind_owned_frames")) || [])
      .filter(c => tousLesCadres.includes(c));

    const cadresContainer = document.getElementById("cadres-list");

    let cadreSelectionTemp = "";

    cadresPossedes.forEach(cadre => {
      const div = document.createElement("div");
      div.className = "cadre-item";
      if (cadre === cadreActuel) div.classList.add("selected-cadre");

      div.innerHTML = `
        <span class="checkmark">✔</span>
        <div class="cadre-preview">
          <img class="photo-cadre" src="./assets/cadres/${cadre}.webp" />
          <img class="photo-user" src="./assets/img/exemple.jpg" />
        </div>
      `;

      div.addEventListener("click", () => {
        cadreSelectionTemp = cadre;
        document.getElementById("popup-cadre-img").src = `./assets/cadres/${cadre}.webp`;
        document.getElementById("popup-cadre").classList.remove("hidden");
        document.getElementById("popup-cadre").classList.add("show");
      });

      cadresContainer.appendChild(div);
    });

    document.getElementById("close-popup").addEventListener("click", () => {
      document.getElementById("popup-cadre").classList.remove("show");
      document.getElementById("popup-cadre").classList.add("hidden");
    });

    document.getElementById("confirmer-cadre").addEventListener("click", () => {
      localStorage.setItem("cadre_selectionne", cadreSelectionTemp);
      document.getElementById("popup-cadre").classList.remove("show");
      document.getElementById("popup-cadre").classList.add("hidden");
      location.reload();
    });
  </script>
</body>
</html>
