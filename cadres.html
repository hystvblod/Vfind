<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VFind - Mes cadres</title>
  <link rel="stylesheet" href="style/main.css"/>
</head>
<body class="vfind-bg">

  <header class="profil-header">
    <a href="profil.html" class="back-btn">ðŸ”™</a>
    <h1>ðŸŽ¨ Mes cadres</h1>
  </header>

  <main>
    <section class="cadres-possedes">
      <div class="grid-cadres" id="cadres-list">
        <!-- Les cadres possÃ©dÃ©s seront injectÃ©s ici -->
      </div>
    </section>

    <section class="cadre-preview-section">
      <h2 style="text-align:center; color:white;">AperÃ§u du cadre sÃ©lectionnÃ©</h2>
      <div class="cadre-preview">
        <img class="photo-cadre" id="cadre-preview-img" src="./assets/cadres/polaroid_01.webp" />
        <img class="photo-user" src="./assets/img/exemple.jpg" />
      </div>
    </section>
  </main>

  <footer>
    <p>Â© 2025 VFind</p>
  </footer>

  <script>
  const cadreActuel = localStorage.getItem("cadre_selectionne") || "polaroid_01";

  const tousLesCadres = ["polaroid_01", "polaroid_02", "polaroid_03", "polaroid_04"];
  const cadresPossedes = (JSON.parse(localStorage.getItem("vfind_owned_frames")) || [])
    .filter(c => tousLesCadres.includes(c));

  const cadresContainer = document.getElementById("cadres-list");

  // GÃ©nÃ©ration de la liste des cadres
  cadresPossedes.forEach(cadre => {
    const div = document.createElement("div");
    div.className = "cadre-item";
    if (cadre === cadreActuel) div.classList.add("selected-cadre");

    div.innerHTML = `
      <span class="checkmark">âœ”</span>
      <div class="cadre-preview">
        <img class="photo-cadre" src="./assets/cadres/${cadre}.webp" />
        <img class="photo-user" src="./assets/img/exemple.jpg" />
      </div>
    `;

    div.addEventListener("click", () => {
      localStorage.setItem("cadre_selectionne", cadre);
      updateSelection(cadre);
    });

    cadresContainer.appendChild(div);
  });

  function updateSelection(newCadre) {
    document.querySelectorAll(".cadre-item").forEach(item => item.classList.remove("selected-cadre"));
    const previewImage = document.getElementById("cadre-preview-img");
    previewImage.src = `./assets/cadres/${newCadre}.webp`;
    const newItem = [...document.querySelectorAll(".cadre-item")].find(item =>
      item.querySelector("img.photo-cadre")?.src.includes(newCadre)
    );
    if (newItem) newItem.classList.add("selected-cadre");
  }

  // Mise Ã  jour de l'aperÃ§u au chargement
  const previewImage = document.getElementById("cadre-preview-img");
  previewImage.src = `./assets/cadres/${cadreActuel}.webp`;
</script>
</body>
</html>
